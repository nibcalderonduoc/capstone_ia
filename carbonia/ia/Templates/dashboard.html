{% extends 'partials/base.html' %}
{% load static %}

{% block title %}Dashboard{% endblock %}

{% block content %}
    <h1>Dashboard de Alcances de Huella de Carbono</h1>

    <div class="charts">
        <!-- Gráfico de Alcance 1 -->
        <div class="chart">
            <h2>Alcance1 - Directas</h2>
            <h1>{{ total_tco2_calculado }}</h1>
            <h2>tCO₂e</h2>
            <a href="{% url 'alcance1' %}">             
                <canvas id="alcance1Chart" style="width:100%; max-width:600px; height:400px;"></canvas>
            </a>
        </div> <!-- Cierra correctamente el div del gráfico de Alcance 1 -->

        <!-- Gráfico de Alcance 2 -->
        <div class="chart">
            <h2>Alcance 2 - Indirectas</h2>
            <h1>{{ total_tco2_calculado2 }}</h1>
            <h2>tCO₂e</h2>
            <a href="{% url 'alcance2' %}">
                <canvas id="alcance2Chart" style="width:100%; max-width:600px; height:400px;"></canvas>
            </a>
        </div> <!-- Cierra correctamente el div del gráfico de Alcance 2 -->

        <!-- Gráfico de Alcance 3 -->
        <div class="chart">
            <h2>Alcance 3 - Otras Indirectas</h2>
            <h1>{{ total_tco2_calculado3 }}</h1>
            <h2>tCO₂e</h2>
            <a href="{% url 'alcance3' %}">
                <canvas id="alcance3Chart" style="width:100%; max-width:600px; height:400px;"></canvas>
            </a>
        </div> <!-- Cierra correctamente el div del gráfico de Alcance 3 -->
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Gráfico de Alcance 1
            var ctx1 = document.getElementById('alcance1Chart').getContext('2d');
            new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: {{ alcance1_labels|safe }},
                    datasets: [{                        
                        data: {{ alcance1_data|safe }},
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 3,
                        backgroundColor: 'rgba(75, 192, 192, 0.1)',
                        tension: 0.4,
                        pointBackgroundColor: 'rgba(75, 192, 192, 1)',
                        pointBorderColor: 'white',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: false,
                        },
                        legend: {
                            display: false,
                        }
                    },
                    scales: {
                        x: { ticks: { font: { size: 0 } } },
                        y: { beginAtZero: true, ticks: { font: { size: 0 } } }
                    }
                }
            });

            // Gráfico de Alcance 2
            var ctx2 = document.getElementById('alcance2Chart').getContext('2d');
            new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: {{ alcance2_labels|safe }},
                    datasets: [{                        
                        data: {{ alcance2_data|safe }},
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 3,
                        backgroundColor: 'rgba(75, 192, 192, 0.1)',
                        tension: 0.4,
                        pointBackgroundColor: 'rgba(75, 192, 192, 1)',
                        pointBorderColor: 'white',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: false,
                        },
                        legend: {
                            display: false,
                        }
                    },
                    scales: {
                        x: { ticks: { font: { size: 0 } } },
                        y: { beginAtZero: true, ticks: { font: { size: 0 } } }
                    }
                }
            });

            // Gráfico de Alcance 3
            var ctx3 = document.getElementById('alcance3Chart').getContext('2d');
            new Chart(ctx3, {
                type: 'line',
                data: {
                    labels: {{ alcance3_labels|safe }},
                    datasets: [{                        
                        data: {{ alcance3_data|safe }},
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 3,
                        backgroundColor: 'rgba(54, 162, 235, 0.1)',
                        tension: 0.4,
                        pointBackgroundColor: 'rgba(54, 162, 235, 1)',
                        pointBorderColor: 'white',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: false,
                        },
                        legend: {
                            display: false,
                        }
                    },
                    scales: {
                        x: { ticks: { font: { size: 0 } } },
                        y: { beginAtZero: true, ticks: { font: { size: 0 } } }
                    }
                }
            });
        });
    </script>
{% endblock %}
